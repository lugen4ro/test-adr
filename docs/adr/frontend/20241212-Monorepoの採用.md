# Monorepoの採用

## ステータス

Approved

## 背景

フロントエンド開発を進めるうえで、Polyrepo と Monorepo のどちらを採用するか検討する必要がある。

## 結論

以下の観点から、Monorepo を採用することとした。

- モジュール毎に package 化することで、フロントエンドのアプリケーションディレクトリをシンプルに保ちたい
- アプリケーション規模、機能が増えていくことによって、触るべきディレクトリをなるべく少なくしたい
- アプリケーション/モジュール間の依存関係を明確にすることで、差し替えや再利用をしやすくしたい

現時点では、以下のモジュールが想定される。

```
.
├── apps
│   ├── storybook# Storybook
│   └── web# アプリケーション
├── packages
│   ├── data-table# データテーブル
│   ├── design-system# 管理用のUIコンポーネント
│   └── form# フォームライブラリとControllableなコンポーネント
└── tools
    └── tsconfig# TypeScript設定
```

- apps
  - 実際に動作するアプリケーションを配置するディレクトリ
- packages
  - アプリケーションで利用するモジュールを配置するディレクトリ
- tools
  - Monorepo の管理に必要なツールを配置するディレクトリ

## 論点

## 適用した結果

## **Pros**

- 開発者は、実施するタスク内容によって触るディレクトリが分かれるため、開発・レビュー効率が向上する
- アプリケーションとモジュールが分かれて管理されることにより、物理的にアプリケーション都合の実装がモジュールに侵入しづらくなる

## **Cons**

- 開発者は、モジュールを実装する際、アプリケーション都合の実装をしないようにする必要がある
- 開発者は、別途Monorepo管理ツールを導入する必要がある
- 開発者は、Monorepoの運用に関する知識が必要となる

## 撤退条件

以下の状況が発生した場合、Polyrepoへの移行を検討する

- ビルド時間が既存の2倍以上に増加し、対策を講じても改善できない
- パッケージ間の依存関係の管理が複雑化し、開発効率が著しく低下する
- チームメンバーの学習コストが想定以上に高く、開発速度に影響が出る
